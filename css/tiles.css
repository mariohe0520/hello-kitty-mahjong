/* ═══════════════════════════════════════════════════════════════
   Hello Kitty 麻将 v2.0 — Tile Styles (Premium 3D)
   ═══════════════════════════════════════════════════════════════ */

/* ─── Base Tile ─── */
.tile {
  width: 36px; height: 48px; min-width: 36px; min-height: 48px;
  background: linear-gradient(175deg, #fffff8 0%, #faf5e8 20%, #f0ead0 60%, #e8e0c0 100%);
  border: 1px solid #c0b898; border-radius: 7px;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  font-weight: 700; cursor: pointer; position: relative;
  overflow: hidden; user-select: none; -webkit-user-select: none;
  box-sizing: border-box; flex-shrink: 0;
  transition: transform 0.12s cubic-bezier(0.34,1.56,0.64,1), box-shadow 0.12s ease;
  box-shadow:
    0 1px 0 0 #e8e0c8,
    0 3px 0 0 #c8b890,
    0 5px 0 0 #b8a878,
    0 6px 2px rgba(0,0,0,0.3),
    inset 0 1px 0 rgba(255,255,255,0.8),
    inset 0 -1px 0 rgba(0,0,0,0.05);
}

.tile::before {
  content: ''; position: absolute;
  bottom: -4px; left: 1px; right: 1px; height: 5px;
  background: linear-gradient(180deg, #d4c8a0, #b8a880);
  border-radius: 0 0 5px 5px; z-index: -1;
}
.tile::after {
  content: ''; position: absolute;
  top: 0; left: 0; right: 0; height: 40%;
  background: linear-gradient(180deg, rgba(255,255,255,0.35), transparent);
  border-radius: 7px 7px 0 0; pointer-events: none; z-index: 3;
}
.tile:active:not(.locked):not(.face-down) {
  transform: translateY(2px);
  box-shadow:
    0 1px 0 0 #d8d0b8,
    0 2px 0 0 #c8b890,
    0 2px 2px rgba(0,0,0,0.15),
    inset 0 1px 0 rgba(255,255,255,0.5);
}

/* ─── SVG tile image ─── */
.tile-img { display: none; }
@media (min-width: 768px) {
  .tile-img {
    position: absolute; top: 5%; left: 10%;
    width: 80%; height: 80%; object-fit: contain;
    display: block; pointer-events: none; z-index: 1;
    opacity: 0.85;
  }
}

/* ─── Selected ─── */
.tile.selected {
  transform: translateY(-12px) scale(1.08);
  box-shadow:
    0 1px 0 0 #e8e0c8,
    0 8px 0 0 #c8b890,
    0 12px 0 0 #b8a878,
    0 14px 4px rgba(0,0,0,0.2),
    0 0 20px rgba(255,107,157,0.4),
    inset 0 1px 0 rgba(255,255,255,0.8);
  border-color: #ff6b9d; z-index: 10;
}

/* ─── Face-down (Hello Kitty pink back) ─── */
.tile.face-down {
  background:
    repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(255,255,255,0.12) 3px, rgba(255,255,255,0.12) 4px),
    repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.06) 3px, rgba(255,255,255,0.06) 4px),
    linear-gradient(135deg, #ff6b9d 0%, #ff8fbf 40%, #ffb3d9 100%);
  border-color: #e55a8a;
  box-shadow:
    0 1px 0 0 #f090b0,
    0 3px 0 0 #c04878,
    0 5px 0 0 #a03860,
    0 6px 2px rgba(0,0,0,0.3),
    inset 0 1px 0 rgba(255,255,255,0.35);
}
.tile.face-down::before { background: linear-gradient(180deg, #e55a8a, #c04878); }
.tile.face-down::after { background: linear-gradient(180deg, rgba(255,255,255,0.25), transparent); }
.tile-back { font-size: 16px; line-height: 1; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2)); }

/* ─── Tile text content ─── */
.tile-rank { font-size: 18px; line-height: 1; font-weight: 900; text-shadow: 0 1px 1px rgba(0,0,0,0.1); pointer-events: none; }
.tile-suit { font-size: 9px; line-height: 1; margin-top: 1px; font-weight: 700; pointer-events: none; }
.tile-honor { font-size: 20px; font-weight: 900; line-height: 1; text-shadow: 0 1px 1px rgba(0,0,0,0.1); pointer-events: none; }

/* ─── Small tiles ─── */
.tile-sm {
  width: 24px; height: 32px; min-width: 24px; min-height: 32px;
  border-radius: 5px;
  box-shadow: 0 1px 0 0 #e8e0c8, 0 2px 0 0 #c8b890, 0 3px 0 0 #b8a878, 0 4px 2px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.6);
}
.tile-sm .tile-rank { font-size: 13px; }
.tile-sm .tile-suit { font-size: 7px; }
.tile-sm .tile-honor { font-size: 14px; }
.tile-sm .tile-back { font-size: 11px; }
.tile-sm::before { height: 3px; }

/* ─── Mini tiles (discard pool) ─── */
.tile-mini {
  width: 18px; height: 24px; min-width: 18px; min-height: 24px;
  border-radius: 3px;
  box-shadow: 0 1px 0 0 #d8d0b8, 0 2px 0 0 #c0b890, 0 3px 2px rgba(0,0,0,0.15);
}
.tile-mini .tile-rank { font-size: 10px; }
.tile-mini .tile-suit { font-size: 6px; }
.tile-mini .tile-honor { font-size: 10px; }
.tile-mini .tile-back { font-size: 8px; }
.tile-mini::before, .tile-mini::after { display: none; }

/* ─── Animations ─── */
@keyframes tileEnter {
  0% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
  60% { transform: translateY(3px) rotateX(-5deg); opacity: 1; }
  100% { transform: translateY(0) rotateX(0); }
}
.tile.entering { animation: tileEnter 0.3s cubic-bezier(0.34,1.56,0.64,1) forwards; }

@keyframes tileDiscard {
  0% { transform: scale(1.2); opacity: 1; }
  40% { transform: scale(0.7) translateY(-30px); opacity: 0.9; }
  100% { transform: scale(0.6) translateY(0); opacity: 1; }
}
.tile.discarding { animation: tileDiscard 0.4s ease forwards; z-index: 50; pointer-events: none; }

.tile.winning { animation: winGlow 0.8s ease-in-out infinite; border-color: #f5c518; }
@keyframes winGlow {
  0%, 100% { box-shadow: 0 1px 0 0 #e8e0c8, 0 3px 0 0 #c8b890, 0 5px 0 0 #b8a878, 0 6px 8px rgba(245,197,24,0.3); }
  50% { box-shadow: 0 1px 0 0 #e8e0c8, 0 3px 0 0 #c8b890, 0 5px 0 0 #b8a878, 0 6px 20px rgba(245,197,24,0.7), 0 0 30px rgba(245,197,24,0.4); }
}

.tile.locked { opacity: 0.9; border-color: #a0a0a0; cursor: default; }

@media (hover: hover) {
  .tile:hover:not(.face-down):not(.locked):not(.selected) {
    transform: translateY(-5px);
    box-shadow: 0 1px 0 0 #e8e0c8, 0 5px 0 0 #c8b890, 0 7px 0 0 #b8a878, 0 9px 4px rgba(0,0,0,0.2);
  }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-4px); }
  40% { transform: translateX(4px); }
  60% { transform: translateX(-3px); }
  80% { transform: translateX(2px); }
}

/* ═══ Game UI Styles ═══ */

.player-area.active-turn { position: relative; }
.player-area.active-turn::after {
  content: ''; position: absolute; inset: -6px;
  border-radius: 12px; border: 2px solid #ff6b9d;
  animation: turnRingPulse 1.5s ease-in-out infinite;
  pointer-events: none;
}
@keyframes turnRingPulse {
  0%, 100% { border-color: rgba(255,107,157,0.6); box-shadow: 0 0 8px rgba(255,107,157,0.3); }
  50% { border-color: rgba(255,107,157,0.2); box-shadow: 0 0 20px rgba(255,107,157,0.1); }
}

/* Action calligraphy */
.action-calligraphy {
  position: fixed; top: 45%; left: 50%;
  transform: translate(-50%, -50%) scale(0);
  font-size: 96px; font-weight: 900; pointer-events: none; z-index: 300;
  text-shadow: 0 0 40px currentColor, 0 4px 8px rgba(0,0,0,0.3);
  animation: calligraphyBurst 0.8s cubic-bezier(0.175,0.885,0.32,1.275) forwards;
  letter-spacing: 4px;
}
@keyframes calligraphyBurst {
  0% { transform: translate(-50%, -50%) scale(0) rotate(-15deg); opacity: 0; filter: blur(8px); }
  25% { transform: translate(-50%, -50%) scale(1.5) rotate(3deg); opacity: 1; filter: blur(0); }
  50% { transform: translate(-50%, -50%) scale(1.15) rotate(-1deg); }
  100% { transform: translate(-50%, -50%) scale(0.9); opacity: 0; filter: blur(4px); }
}

.action-calligraphy.action-hu {
  font-size: 120px;
  background: linear-gradient(180deg, #fff8dc, #f5c518, #d4a017, #f5c518, #fff8dc);
  background-size: 100% 200%;
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  animation: calligraphyBurst 1s cubic-bezier(0.175,0.885,0.32,1.275) forwards,
             goldenShimmer 0.6s ease-in-out 3;
  text-shadow: none;
  filter: drop-shadow(0 0 30px rgba(245,197,24,0.7));
}
@keyframes goldenShimmer { 0% { background-position: 0% 0%; } 100% { background-position: 0% 200%; } }

/* Remaining tiles ring */
.remaining-ring { width: 56px; height: 56px; position: relative; filter: drop-shadow(0 0 8px rgba(245,197,24,0.2)); }
.remaining-ring svg { transform: rotate(-90deg); }
.remaining-ring .ring-text {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  display: inline-flex; width: 40px; height: 40px; border-radius: 50%;
  align-items: center; justify-content: center;
  font-size: 16px; font-weight: 900; color: #f5c518;
  text-shadow: 0 0 8px rgba(245,197,24,0.5);
}
.remaining-ring .ring-label {
  position: absolute; bottom: -14px; left: 50%;
  transform: translateX(-50%); font-size: 10px;
  color: rgba(255,255,255,0.5); white-space: nowrap;
}

.meld-group { display: flex; gap: 1px; margin: 0 4px; opacity: 0.95; }
.meld-group .tile { cursor: default; }

.mahjong-table::before {
  content: ''; position: absolute; inset: 0; border-radius: 20px;
  background: radial-gradient(ellipse at 50% 40%, rgba(255,255,255,0.06), transparent 60%);
  pointer-events: none; z-index: 0;
}
.mahjong-table > * { position: relative; z-index: 1; }

/* Pulse for action buttons */
@keyframes actionPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
